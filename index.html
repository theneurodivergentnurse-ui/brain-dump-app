<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>To-Do List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .task {
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      color: #000;
    }
    .task .title {
      font-weight: bold;
    }
    .task .buttons {
      margin-top: 0.5rem;
    }
    .reminder-btn {
      margin-right: 0.5rem;
    }
    .completed {
      text-decoration: line-through;
      opacity: 0.6;
    }
  </style>
</head>
<body class="container py-4">
  <h1 class="mb-4">üß† Brain Dump To-Do List</h1>

  <form id="taskForm">
    <div class="mb-3">
      <label for="title" class="form-label">Title *</label>
      <input type="text" id="title" class="form-control" required>
    </div>
    <div class="mb-3">
      <label for="description" class="form-label">Description (optional)</label>
      <textarea id="description" class="form-control" rows="2"></textarea>
    </div>
    <div class="mb-3">
      <label class="form-label">Reminder:</label><br>
      <button type="button" class="btn btn-danger reminder-btn" data-time="1h">Remind in 1 hour</button>
      <button type="button" class="btn btn-warning reminder-btn" data-time="1d">Remind in 1 day</button>
      <button type="button" class="btn btn-success reminder-btn" data-time="1w">Remind in 1 week</button>
      <button type="button" class="btn btn-info reminder-btn" data-time="2w">Remind in 2 weeks</button>
    </div>
    <input type="hidden" id="selectedReminder" required>
    <button type="submit" class="btn btn-primary">Add Task</button>
  </form>

  <hr class="my-4">
  <h2>üìù Tasks</h2>
  <div id="taskList"></div>

  <script>
    const reminderMap = {
      '1h': { label: 'Remind in 1 hour', color: '#FF4C4C' },
      '1d': { label: 'Remind in 1 day', color: '#F9D342' },
      '1w': { label: 'Remind in 1 week', color: '#4CAF50' },
      '2w': { label: 'Remind in 2 weeks', color: '#82CAFF' },
    };

    const taskForm = document.getElementById('taskForm');
    const taskList = document.getElementById('taskList');
    const selectedReminder = document.getElementById('selectedReminder');

    document.querySelectorAll('.reminder-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        selectedReminder.value = btn.dataset.time;
        document.querySelectorAll('.reminder-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    function saveTasks(tasks) {
      localStorage.setItem('brainDumpTasks', JSON.stringify(tasks));
    }

    function getTasks() {
      return JSON.parse(localStorage.getItem('brainDumpTasks') || '[]');
    }

    function renderTasks() {
      const tasks = getTasks();
      taskList.innerHTML = '';
      tasks.forEach((task, index) => {
        const div = document.createElement('div');
        div.className = 'task';
        div.style.backgroundColor = reminderMap[task.reminder].color;
        if (task.done) div.classList.add('completed');

        div.innerHTML = `
          <div class="title">${task.title}</div>
          <div>${task.description || ''}</div>
          <div><small>${reminderMap[task.reminder].label}</small></div>
          <div class="buttons">
            <button class="btn btn-sm btn-outline-success me-2" onclick="toggleDone(${index})">${task.done ? 'Undo' : 'Mark as Done'}</button>
            <button class="btn btn-sm btn-outline-secondary" onclick="editReminder(${index})">Change Reminder</button>
          </div>
        `;
        taskList.appendChild(div);
      });
    }

    function toggleDone(index) {
      const tasks = getTasks();
      tasks[index].done = !tasks[index].done;
      saveTasks(tasks);
      renderTasks();
    }

    function editReminder(index) {
      const newTime = prompt('Enter new reminder: 1h, 1d, 1w, 2w');
      if (reminderMap[newTime]) {
        const tasks = getTasks();
        tasks[index].reminder = newTime;
        saveTasks(tasks);
        renderTasks();
      } else {
        alert('Invalid reminder. Use: 1h, 1d, 1w, 2w');
      }
    }

    taskForm.addEventListener('submit', e => {
      e.preventDefault();
      if (!selectedReminder.value) {
        alert('Please select a reminder.');
        return;
      }
      const task = {
        title: document.getElementById('title').value.trim(),
        description: document.getElementById('description').value.trim(),
        reminder: selectedReminder.value,
        done: false,
      };
      const tasks = getTasks();
      tasks.push(task);
      saveTasks(tasks);
      taskForm.reset();
      selectedReminder.value = '';
      document.querySelectorAll('.reminder-btn').forEach(b => b.classList.remove('active'));
      renderTasks();
    });

    // Load tasks when page is opened
    renderTasks();
  </script>
</body>
</html>
